# Weed Segmentation Model  
**Семантическая сегментация сорняков на изображениях пшеницы**

### Краткое описание модели
- **Архитектура**: DeepLabV3+ с бэкбоном **MobileNetV3-Large**  
- **Классы**:  
  - 0 — Background  
  - 1 — Crop (пшеница)  
  - 2 — Weed (сорняки)  
- **Входное разрешение**: 512 × 512  
- **Transfer learning**:  
  – Предобучена на **COCO** Pascal **VOC** (torchvision `weights="DEFAULT"`)  
  – Дообучена на открытом датасете **NASSAR2020**

### Быстрый старт

```bash
# Установка зависимостей
pip install -r requirements.txt

# Обучение (если нужно переобучить)
python train.py \
    --root-dir /path/to/dataset \
    --epochs * \
    --batch-size * \
    --weights-dir ./weights

# Инференс на тестовом наборе
python infer.py \
    --weights weights/best_model.pth \
    --save-dir predictions

# Позднее будет добавлен другой inference.py

# Бенчмарк + поиск плохих кейсов(IoU<0.5)
python benchmark.py weights/best_model.pth
```
### Результаты модели на тестовом наборе (266 изображений)

#### Основные метрики

| Метрика                  | Значение    |
|--------------------------|-------------|
| **mIoU**                 | **0.8420**  |
| Pixel Accuracy           | 0.9707      |
| Mean F1-score            | 0.9117      |
| FPS (inference, T4 GPU) | ~37-40 |

#### IoU и F1 по классам

| Класс         | IoU       | F1-score   |
|---------------|-----------|------------|
| Background    | 0.9702    | 0.9849     |
| Crop (пшеница)| 0.7820    | 0.8777     |
| **Weed (сорняки)** | **0.7739** | **0.8726** |

### Примечание по датасету

Датасет **NASSAR2020** (изображения полей пшеницы с пиксельной разметкой сорняков) **не включён** в репозиторий из-за большого объёма.

Ожидаемая структура данных (пути настраиваются в `config.py`):

```text
/dataset
├── data_list/
│   ├── train.txt      # список имён файлов для обучения (без расширения)
│   ├── val.txt        # список имён файлов для валидации
│   └── test.txt       # список имён файлов для теста
├── images/            # исходные RGB-изображения
│   └── *.png
└── mask/              # одноканальные маски (значения пикселей: 0, 1, 2)
    └── *.png
```
